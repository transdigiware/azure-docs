---
title: Scan registry images with Azure Defender
description: Learn about using Azure Defender for container registries to scan images in your Azure container registries
ms.topic: article
ms.date: 05/19/2021
---

# Scan registry images with Azure Defender

To scan images in your Azure container registries for vulnerabilities, you can integrate one of the available Azure Marketplace solutions or, if you want to use Azure Security Center, optionally enable **Azure Defender for container registries** at the subscription level. 

* Learn more about [Azure Defender for container registries](../security-center/defender-for-container-registries-introduction.md)
* Learn more about [container security in Azure Security Center](../security-center/container-security.md)

## Registry operations by Azure Defender

Azure Defender scans images that are pushed to a registry, imported into a registry, or any images pulled within the last 30 days. If vulnerabilities are detected, [recommended remediations](../security-center/defender-for-container-registries-usage.md#view-and-remediate-findings) appear in Azure Security Center.

 After you've taken the recommended steps to remediate the security issue, replace the image in your registry. Azure Defender rescans the image to confirm that the vulnerabilities are remediated. 

For details, see [Use Azure Defender for container registries](../security-center/defender-for-container-registries-usage.md).

> [!TIP]
> Azure Defender authenticates with the registry to pull images for vulnerability scanning. If [resource logs](monitor-service-reference.md#resource-logs) are collected for your registry, you'll see registry login events and image pull events generated by Azure Defender. These events are associated with an alphanumeric ID such as `b21cb118-5a59-4628-bab0-3c3f0e434cg6`.

## Scanning a network-restricted registry

Azure Defender can scan images in a publicly accessible container registry or one that's protected with network access rules. If network rules are configured (that is, you disable public registry access, configure IP access rules, or create private endpoints), be sure to enable the network setting to [**allow trusted Microsoft services**](allow-access-trusted-services.md) to access the registry. By default, this setting is enabled in a new container registry.

## Next steps

* Learn more about registry access by [trusted services](allow-access-trusted-services.md).
* To restrict access to a registry using a private endpoint in a virtual network, see [Configure Azure Private Link for an Azure container registry](container-registry-private-link.md).
* To set up registry firewall rules, see [Configure public IP network rules](container-registry-access-selected-networks.md).
